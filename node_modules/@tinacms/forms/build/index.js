!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("final-form-arrays"),require("final-form")):"function"==typeof define&&define.amd?define(["exports","final-form-arrays","final-form"],e):e((t=t||self)["@tinacms/forms"]={},t.arrayMutators,t.finalForm)}(this,function(t,s,c){"use strict";s=s&&s.hasOwnProperty("default")?s.default:s;var p=function(){return(p=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function h(n,r){var i,o,a,t,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(a=2&e[0]?o.return:e[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,e[1])).done)return a;switch(o=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){u.label=e[1];break}if(6===e[0]&&u.label<a[1]){u.label=a[1],a=e;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(e);break}a[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}var e=(n.prototype.updateFields=function(t){this.fields=t},Object.defineProperty(n.prototype,"mutators",{get:function(){return this.finalForm.mutators},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"values",{get:function(){return this.finalForm.getState().values},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"name",{get:function(){return this.id},enumerable:!0,configurable:!0}),n.prototype.updateValues=function(t){var e=this;this.finalForm.batch(function(){e.finalForm.getState().active?u(e.finalForm,t):r(e.finalForm,t)})},n.prototype.updateInitialValues=function(e){var n=this;this.finalForm.batch(function(){var t=n.values;n.finalForm.initialize(e),n.finalForm.getState().active?u(n.finalForm,t):r(n.finalForm,t)})},n);function n(t){var n=this,e=t.id,r=t.label,i=t.fields,o=t.actions,a=t.reset,u=t.loadInitialValues,l=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(t,["id","label","fields","actions","reset","loadInitialValues"]);this.subscribe=function(t,e){return n.finalForm.subscribe(t,e)},this.submit=function(){return n.finalForm.submit()};var f=l.initialValues||{};this.__type=l.__type||"form",this.id=e,this.label=r,this.fields=i,this.finalForm=c.createForm(p(p({},l),{initialValues:f,onSubmit:function(n,r,i){return function(o,a,u,l){return new(u=u||Promise)(function(t,e){function n(t){try{i(l.next(t))}catch(t){e(t)}}function r(t){try{i(l.throw(t))}catch(t){e(t)}}function i(e){e.done?t(e.value):new u(function(t){t(e.value)}).then(n,r)}i((l=l.apply(o,a||[])).next())})}(this,void 0,void 0,function(){var e;return h(this,function(t){switch(t.label){case 0:return[4,l.onSubmit(n,r,i)];case 1:return e=t.sent(),r.initialize(n),[2,e]}})})},mutators:p(p({},s),l.mutators)})),this.meta=l.meta||{},this.reset=a,this.actions=o||[],this.initialValues=f,this.updateFields(this.fields),u&&u().then(function(t){n.updateInitialValues(t)})}function r(r,t){Object.entries(t).forEach(function(t){var e=t[0],n=t[1];r.change(e,n)})}function u(i,t,o){var a=i.getState().active;Object.entries(t).forEach(function(t){var e=t[0],n=t[1],r=o?o+"."+e:e;"object"==typeof n?a.startsWith(r)?u(i,n,r):i.change(r,n):r!==a&&i.change(r,n)})}t.Form=e,Object.defineProperty(t,"__esModule",{value:!0})});
